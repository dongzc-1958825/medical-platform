<<<<<<< HEAD
// src/App.tsx
import React, { useState, useEffect } from 'react';
import { HashRouter as Router, Routes, Route, Navigate } from 'react-router-dom';
import MainLayout from './components/MainLayout';
import HomePage from './pages/HomePage';
import CasesPage from './pages/CasesPage';
import CreateCasePage from './pages/CreateCasePage';
import HelpPage from './pages/HelpPage';
import MessagesPage from './pages/MessagesPage';
import ProfilePage from './pages/ProfilePage';
import LoginPage from './pages/LoginPage';
import ConsultationDetailPage from './pages/ConsultationDetailPage';
import CommunityPage from './pages/CommunityPage';
import { User } from './types';
=======
// ========== ç”Ÿäº§ç¯å¢ƒæµ‹è¯• - Appç»„ä»¶è°ƒè¯• ==========
console.log('ğŸ§© [DEBUG] App.tsx å¼€å§‹æ‰§è¡Œ');
console.log('ğŸ§© [DEBUG] å½“å‰hash:', window.location.hash);
console.log('ğŸ§© [DEBUG] å®Œæ•´URL:', window.location.href);
// ========== è°ƒè¯•ä»£ç ç»“æŸ ==========
>>>>>>> 009285bd20e22a736597077d1ebfb6f9622de08f

import { HashRouter, Routes, Route } from 'react-router-dom';
import React from 'react';

// ç®€å•æµ‹è¯•ç»„ä»¶ - ä¸å¯¼å…¥ä»»ä½•ä¸šåŠ¡ç»„ä»¶
function TestApp() {
  console.log('ğŸ§© [DEBUG] TestAppç»„ä»¶æ¸²æŸ“å¼€å§‹');
  console.log('ğŸ” [DEBUG] TestAppå‡½æ•°æ‰§è¡Œï¼Œå‡†å¤‡è¿”å›JSX');
  
  // æ·»åŠ æ¸²æŸ“åçš„æ£€æŸ¥
  React.useEffect(() => {
    console.log('ğŸ” [DEBUG] TestAppç»„ä»¶æŒ‚è½½å®Œæˆ');
    console.log('ğŸ” [DEBUG] æ£€æŸ¥æ ¹å…ƒç´ å†…å®¹:', document.getElementById('root')?.innerHTML?.substring(0, 200) + '...');
    console.log('ğŸ” [DEBUG] æ£€æŸ¥TestAppæ¸²æŸ“çš„å…ƒç´ :', document.querySelector('[data-testid="test-app"]'));
    
    // æ£€æŸ¥æ ·å¼
    const testAppElement = document.querySelector('[data-testid="test-app"]');
    if (testAppElement) {
      console.log('ğŸ” [DEBUG] TestAppå…ƒç´ æ‰¾åˆ°ï¼Œæ£€æŸ¥æ ·å¼:');
      console.log('- display:', window.getComputedStyle(testAppElement).display);
      console.log('- visibility:', window.getComputedStyle(testAppElement).visibility);
      console.log('- opacity:', window.getComputedStyle(testAppElement).opacity);
      console.log('- height:', window.getComputedStyle(testAppElement).height);
    } else {
      console.error('ğŸ” [DEBUG] TestAppå…ƒç´ æœªæ‰¾åˆ°ï¼');
    }
  }, []);
  
  return (
    <div 
      data-testid="test-app"
      style={{ 
        padding: '50px', 
        textAlign: 'center', 
        backgroundColor: '#f0f9ff',
        minHeight: '100vh',
        display: 'flex',
        flexDirection: 'column',
        justifyContent: 'center',
        alignItems: 'center',
        // æ·»åŠ æ˜æ˜¾çš„è¾¹æ¡†ç¡®ä¿å¯è§
        border: '10px solid red',
        boxSizing: 'border-box'
      }}
    >
      <div style={{
        background: 'white',
        padding: '40px',
        borderRadius: '16px',
        boxShadow: '0 4px 20px rgba(0,0,0,0.1)',
        maxWidth: '600px',
        width: '100%'
      }}>
        <h1 style={{ 
          color: '#10b981', 
          fontSize: '2.5rem',
          marginBottom: '20px'
        }}>
          âœ… æµ‹è¯•æˆåŠŸ - Appç»„ä»¶æ¸²æŸ“æ­£å¸¸
        </h1>
        
        <p style={{ 
          fontSize: '1.2rem',
          color: '#4b5563',
          marginBottom: '30px'
        }}>
          å¦‚æœçœ‹åˆ°è¿™ä¸ªé¡µé¢ï¼Œè¯´æ˜React Routerå’ŒåŸºç¡€æ¸²æŸ“æ­£å¸¸
        </p>
        
        <div style={{ 
          marginTop: '30px', 
          padding: '25px', 
          background: '#f8fafc', 
          borderRadius: '12px',
          textAlign: 'left'
        }}>
          <h3 style={{ color: '#3b82f6', marginTop: 0 }}>è°ƒè¯•ä¿¡æ¯ï¼š</h3>
          <div style={{ fontFamily: 'monospace', fontSize: '14px' }}>
            <p><strong>ç¯å¢ƒæ¨¡å¼:</strong> {import.meta.env.MODE}</p>
            <p><strong>Base URL:</strong> {import.meta.env.BASE_URL}</p>
            <p><strong>å½“å‰æ—¶é—´:</strong> {new Date().toLocaleString()}</p>
            <p><strong>é¡µé¢URL:</strong> {window.location.href}</p>
            <p><strong>Hashè·¯ç”±:</strong> {window.location.hash || '(ç©º)'}</p>
            <p><strong>ç”¨æˆ·ä»£ç†:</strong> {navigator.userAgent.substring(0, 80)}...</p>
          </div>
        </div>
        
        <div style={{ marginTop: '40px' }}>
          <button 
            onClick={() => {
              console.log('ğŸ”„ æ‰‹åŠ¨å¯¼èˆªåˆ° /test');
              window.location.hash = '#/test';
            }}
            style={{
              padding: '12px 24px',
              background: '#3b82f6',
              color: 'white',
              border: 'none',
              borderRadius: '8px',
              fontSize: '1rem',
              cursor: 'pointer',
              marginRight: '10px'
            }}
          >
            æµ‹è¯•è·¯ç”±è·³è½¬ (/test)
          </button>
          
          <button 
            onClick={() => {
              console.log('ğŸ” æ£€æŸ¥localStorage');
              console.log('localStorage:', Object.keys(localStorage));
            }}
            style={{
              padding: '12px 24px',
              background: '#8b5cf6',
              color: 'white',
              border: 'none',
              borderRadius: '8px',
              fontSize: '1rem',
              cursor: 'pointer'
            }}
          >
            æ£€æŸ¥å­˜å‚¨
          </button>
        </div>
      </div>
      
      <footer style={{ marginTop: '40px', color: '#6b7280', fontSize: '0.9rem' }}>
        <p>ä¼—åˆ›åŒ»æ¡ˆå¹³å° - ç”Ÿäº§ç¯å¢ƒè°ƒè¯•ç‰ˆæœ¬</p>
        <p>æ„å»ºæ—¶é—´: {new Date().toLocaleString()}</p>
      </footer>
    </div>
  );
}

function App() {
  console.log('ğŸ§© [DEBUG] Appç»„ä»¶å‡½æ•°æ‰§è¡Œ');
  
  // ä½¿ç”¨æç®€é…ç½®ï¼Œé¿å…ä»»ä½•å¤æ‚é€»è¾‘
  const basename = import.meta.env.BASE_URL || '/medical-platform/';
  console.log('ğŸ§© [DEBUG] Router basename:', basename);
  
  return (
    <HashRouter basename={basename}>
      <Routes>
        {/* æµ‹è¯•è·¯ç”± */}
        <Route path="/test" element={
          <div style={{ padding: '40px', textAlign: 'center' }}>
            <h2>è·¯ç”±æµ‹è¯•é¡µé¢</h2>
            <p>è·¯ç”±è·³è½¬æˆåŠŸï¼</p>
            <button onClick={() => window.history.back()}>è¿”å›</button>
          </div>
        } />
        
        {/* ä¸»è·¯ç”± - ä½¿ç”¨æµ‹è¯•ç»„ä»¶ */}
        <Route path="/*" element={<TestApp />} />
      </Routes>
    </HashRouter>
  );
}

// é”™è¯¯è¾¹ç•Œ - æ•è·ç»„ä»¶å†…é”™è¯¯
class ErrorBoundary extends React.Component<{children: React.ReactNode}, {hasError: boolean, error: Error | null}> {
  constructor(props: {children: React.ReactNode}) {
    super(props);
    this.state = { hasError: false, error: null };
  }

  static getDerivedStateFromError(error: Error) {
    return { hasError: true, error };
  }

  render() {
    if (this.state.hasError) {
      return (
        <div style={{ padding: '40px', color: 'red', textAlign: 'center' }}>
          <h2>Appç»„ä»¶å†…éƒ¨é”™è¯¯</h2>
          <pre>{this.state.error?.toString()}</pre>
          <button onClick={() => window.location.reload()}>é‡æ–°åŠ è½½</button>
        </div>
      );
    }

    return this.props.children;
  }
}

// åŒ…è£…Appç»„ä»¶
export default function AppWrapper() {
  console.log('ğŸ§© [DEBUG] AppWrapperæ‰§è¡Œ');
  return (
    <ErrorBoundary>
      <App />
    </ErrorBoundary>
  );
}